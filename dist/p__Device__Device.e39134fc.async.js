"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[7315],{78491:function(et,N,a){a.r(N),a.d(N,{default:function(){return Te}});var de=a(12741),c=a.n(de),ue=a(24969),U=a(38402),$=a(30028),ve=a(71230),K=a(15746),Y=a(21802),g=a(71577),fe=a(30381),D=a.n(fe),tt=a(29218),l=a(67294),V=a(64593),he=a(11281),f=a.n(he),xe=a(97983),y=a.n(xe),me=a(40794),O=a.n(me),je=a(45428),p=a(38405),ge=a(78120),ye=a(5077),W=a(28530),pe=a(69408),Se=a(91321),d=a(62816),H=a(23349),Ce=a(69677),h=a(26713),A=a(14538),B=a(20550),De=a(13013),Z=a(66516),Ze=a(18537),Ie=a(42054),Re=a.n(Ie),e=a(85893),$e=(0,Se.Z)({scriptUrl:"//at.alicdn.com/t/c/font_3875475_w5k22iyjel.js"}),u=H.Z.Column;D().locale("en");var Ee=function(E){var I=E.isFocused,k=E.counter,Q=l.useState([]),R=c()(Q,2),X=R[0],Oe=R[1],ke=l.useState(!1),J=c()(ke,2),Me=J[0],S=J[1],Pe=l.useState(""),b=c()(Pe,2),ze=b[0],M=b[1],we=l.useState(""),q=c()(we,2),Ne=q[0],_=q[1],ee=l.useRef(null),Ue=l.useState([]),te=c()(Ue,2),nt=te[0],Ke=te[1],L=Ze.Z.parse(window.location.search),Ye=l.useState(!1),ne=c()(Ye,2),Ve=ne[0],P=ne[1],We=l.useState({}),ae=c()(We,2),m=ae[0],z=ae[1],He=l.useState([]),re=c()(He,2),Ae=re[0],Be=re[1],Ge=l.useState(!1),se=c()(Ge,2),Qe=se[0],T=se[1],Xe=l.useState(!1),ie=c()(Xe,2),Je=ie[0],oe=ie[1],w=function(){var i=O()(y()().mark(function t(){var n;return y()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return S(!0),s.next=3,(0,W._v)({params:L});case 3:n=s.sent,S(!1),n.error||(n.data.map(function(o,v){n.data[v].area_name=o.Nebula_Area.area_name,n.data[v].tenant_name=o.Nebula_Tenant.name}),Oe(n.data),Ke(n.data));case 6:case"end":return s.stop()}},t)}));return function(){return i.apply(this,arguments)}}(),be=function(){var i=O()(y()().mark(function t(){var n;return y()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return S(!0),s.next=3,(0,W.We)({},L.node_type);case 3:n=s.sent,S(!1),n.error||Be(n.data);case 6:case"end":return s.stop()}},t)}));return function(){return i.apply(this,arguments)}}();l.useEffect(function(){I?(w(),be()):$.history.push("/device/Node")},[I,k]);var le=function(t,n,r){n(),M(t[0]),_(r)},qe=function(t){t(),M("")},j=function(t){return{filterDropdown:function(r){var s=r.setSelectedKeys,o=r.selectedKeys,v=r.confirm,x=r.clearFilters,ce=r.close;return(0,e.jsxs)("div",{style:{padding:8},onKeyDown:function(F){return F.stopPropagation()},children:[(0,e.jsx)(Ce.Z,{ref:ee,placeholder:"Search ".concat(t),value:o[0],onChange:function(F){return s(F.target.value?[F.target.value]:[])},onPressEnter:function(){return le(o,v,t)},style:{marginBottom:8,display:"block"}}),(0,e.jsxs)(h.Z,{children:[(0,e.jsx)(g.Z,{type:"primary",onClick:function(){return le(o,v,t)},icon:(0,e.jsx)(d.l62,{}),size:"small",style:{width:90},children:"Search"}),(0,e.jsx)(g.Z,{onClick:function(){return x&&qe(x)},size:"small",style:{width:90},children:"Reset"}),(0,e.jsx)(g.Z,{type:"link",size:"small",onClick:function(){v({closeDropdown:!1}),M(o[0]),_(t)},children:"Filter"}),(0,e.jsx)(g.Z,{type:"link",size:"small",onClick:function(){ce()},children:"close"})]})]})},filterIcon:function(r){return(0,e.jsx)(d.l62,{style:{color:r?"#1890ff":void 0}})},onFilter:function(r,s){var o;return((o=s[t])!==null&&o!==void 0?o:"").toString().toLowerCase().includes(r.toLowerCase())},onFilterDropdownOpenChange:function(r){r&&setTimeout(function(){var s;return(s=ee.current)===null||s===void 0?void 0:s.select()},100)},render:function(r){return Ne===t?(0,e.jsx)(Re(),{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[ze],autoEscape:!0,textToHighlight:r?r.toString():""}):r}}},_e=function(t){A.Z.confirm({title:"Do you Want to unsign these node?",icon:(0,e.jsx)(d.SYL,{}),content:"Device Eui: "+t.devEui,onOk:function(){var n=O()(y()().mark(function s(){var o;return y()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return S(!0),x.next=3,(0,pe.TZ)({devEui:t.devEui,node_id:t.id});case 3:o=x.sent,S(!1),o.error||A.Z.success({content:"Success unsigned node "+t.devEui,onOk:function(){w()}});case 6:case"end":return x.stop()}},s)}));function r(){return n.apply(this,arguments)}return r}(),onCancel:function(){console.log("Cancel")}})};return(0,e.jsxs)(U._z,{childrenContentStyle:{minHeight:"70vh"},title:" ",extra:void 0,children:[(0,e.jsxs)(V.q,{children:[(0,e.jsx)("meta",{charSet:"utf-8"}),(0,e.jsx)("title",{children:"IKI IoT Platform | Device"}),(0,e.jsx)("link",{rel:"icon",href:"/iki-logo-no-text.png",type:"image/x-icon"})]}),(0,e.jsx)(ye.X,{device_id:m.id,open:Ve,onCancel:function(){return P(!1)},onOk:function(){P(!1)},typeName:L.node_type_name,devEui:m.devEui,desc:m.description}),(0,e.jsx)(je.Y,{devEui:m.devEui,open:Qe,interval:m.interval,onCancel:function(){T(!1)},onOk:function(){T(!1),w()}}),(0,e.jsx)(ge.T,{devEui:m.devEui,dataModal:m,open:Je,onCancel:function(){oe(!1)},onOk:function(){oe(!1)},typeName:L.node_type_name}),(0,e.jsxs)(H.Z,{dataSource:X,loading:Me,scroll:{x:1300},children:[(0,e.jsx)(u,f()(f()({},j("tenant_name")),{},{width:200,title:"Tenant",dataIndex:"tenant_name",sorter:function(t,n){return t.tenant_name.length-n.tenant_name.length}})),(0,e.jsx)(u,f()({width:200,title:"Device Type",dataIndex:"device_type"},j("device_type")),"device_type"),(0,e.jsx)(u,f()({width:200,title:"Dev Eui",dataIndex:"devEui"},j("devEui")),"devEui"),(0,e.jsx)(u,f()({width:200,title:"Meter Id",dataIndex:"meter_id"},j("meter_id")),"meter_id"),(0,e.jsx)(u,f()({width:200,title:"Totalizer",dataIndex:"totalizer"},j("totalizer")),"totalizer"),(0,e.jsx)(u,{width:200,title:"Last Update",dataIndex:"lastUpdate",render:function(t){if(t)return D()(t).format("MMM DD YYYY HH:mm:ss")},sorter:function(t,n){return D()(t.lastUpdate).unix()-D()(n.lastUpdate).unix()}},"lastUpdate"),(0,e.jsx)(u,f()(f()({width:200,title:"Status",dataIndex:"status"},j("status")),{},{sorter:function(t,n){return t.status.length-n.status.length},render:function(t){return t==="ONLINE"?(0,e.jsx)(B.Z,{color:"green",children:t}):(0,e.jsx)(B.Z,{color:"red",children:t})}}),"status"),(0,e.jsx)(u,{width:130,title:"Interval",dataIndex:"interval",sorter:function(t,n){return t.interval-n.interval},render:function(t){return(0,e.jsxs)(h.Z,{children:[(0,e.jsx)(d.Wyb,{style:{color:"gray"}}),(0,e.jsxs)(Y.Z,{children:[t," min"]})]})}},"interval"),(0,e.jsx)(u,{width:150,title:"Battery Level",dataIndex:"battery",sorter:function(t,n){return t.battery-n.battery},filters:[{text:(0,e.jsxs)(h.Z,{children:[(0,e.jsx)(p.QP,{}),"50 - 100"]}),value:"50-100"},{text:(0,e.jsxs)(h.Z,{children:[(0,e.jsx)(p.xT,{}),"20 - 50"]}),value:"20-50"},{text:(0,e.jsxs)(h.Z,{children:[(0,e.jsx)(p.t3,{style:{marginLeft:"3px"}})," ","0 - 20"]}),value:"0-20"}],onFilter:function(t,n){return t==="50-100"?n.battery>50:t==="20-50"?n.battery>20&&n.battery<=50:t==="0-20"?n.battery<=20:!0},render:function(t){return(0,e.jsx)(e.Fragment,{children:t>20&&t<=50?(0,e.jsxs)(h.Z,{children:[(0,e.jsx)(p.xT,{}),t]}):t<=20?(0,e.jsxs)(h.Z,{children:[(0,e.jsx)(p.t3,{}),t]}):t>50?(0,e.jsxs)(h.Z,{children:[(0,e.jsx)(p.QP,{}),t]}):null})}},"battery"),(0,e.jsx)(u,f()({width:200,title:"Description",dataIndex:"description"},j("description")),"description"),(0,e.jsx)(u,{dataIndex:"id",width:80,title:"Action",fixed:"right",render:function(t,n){return(0,e.jsx)(De.Z,{trigger:["click"],overlay:(0,e.jsxs)(Z.Z,{children:[(0,e.jsxs)(Z.Z.Item,{onClick:function(){P(!0),z(n)},children:[(0,e.jsx)(d.lY0,{}),"  ","View Log"]},"1"),(0,e.jsxs)(Z.Z.Item,{onClick:function(){$.history.push("/device/edit?id=".concat(n.id,"&area_id=").concat(n.area_id,"&tenant_id=").concat(n.tenant_id))},children:[(0,e.jsx)(d.pW8,{}),"  ","Edit Device"]},"edit-device"),Ae.map(function(r){var s=(0,e.jsx)(d.pW8,{}),o=function(){T(!0),z(n)};switch(r){case"interval":s=(0,e.jsx)(d.Wyb,{}),o=function(){T(!0),z(n)};break;case"meter reading":s=(0,e.jsx)(d.dU4,{});break;case"valve":s=(0,e.jsx)($e,{type:"icon-valve"});break;default:break}return(0,e.jsxs)(Z.Z.Item,{onClick:function(){o()},style:{textTransform:"capitalize"},children:[s," ",r]},r)}),(0,e.jsxs)(Z.Z.Item,{onClick:function(){_e(n)},style:{color:"red"},children:[(0,e.jsx)(d.E0z,{})," Unsign"]},"3")]}),placement:"bottomRight",children:(0,e.jsx)(g.Z,{type:"text",children:(0,e.jsx)(d.xjY,{})})})}},"id")]})]})},G=Ee;D().locale("en");var Le=function(){var E=l.useState(1),I=c()(E,2),k=I[0],Q=I[1],R=(0,$.useParams)();return R.sub=="list"?(0,e.jsx)(G,{isFocused:!0,counter:k}):(0,e.jsxs)(U._z,{title:" ",style:{borderTop:"1px solid rgba(0, 0, 0, 0.06)"},childrenContentStyle:{minHeight:"75vh"},children:[(0,e.jsxs)(V.q,{children:[(0,e.jsx)("meta",{charSet:"utf-8"}),(0,e.jsx)("title",{children:"IKI IoT Platform | Device"}),(0,e.jsx)("link",{rel:"icon",href:"/iki-logo-no-text.png",type:"image/x-icon"})]}),(0,e.jsxs)(ve.Z,{gutter:[16,16],children:[(0,e.jsxs)(K.Z,{xs:24,sm:24,md:24,lg:24,xl:24,xxl:24,style:{display:"flex",justifyContent:"space-between",borderBottom:"1px solid rgba(0, 0, 0, 0.06)",paddingBottom:"18px"},children:[(0,e.jsx)(Y.Z.Title,{level:4,children:"Device Management"}),R.id?(0,e.jsxs)(g.Z,{style:{},onClick:function(){$.history.push("/device/create")},children:[(0,e.jsx)(ue.Z,{})," Add Device"]}):null]}),(0,e.jsx)(K.Z,{span:24,children:(0,e.jsx)(G,{isFocused:!0,counter:0})})]})]})},Te=Le}}]);
