"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[7315],{78491:function(ft,Y,a){a.r(Y),a.d(Y,{default:function(){return Ke}});var me=a(12741),c=a.n(me),ye=a(24969),V=a(38402),O=a(30028),je=a(71230),W=a(15746),A=a(21802),Z=a(71577),ge=a(30381),E=a.n(ge),ht=a(29218),l=a(67294),B=a(64593),pe=a(11281),j=a.n(pe),Se=a(97983),I=a.n(Se),Ce=a(40794),k=a.n(Ce),De=a(99399),G=a.n(De),Ze=a(45428),R=a(38405),Ie=a(78120),Re=a(5077),Q=a(28530),$e=a(69408),Te=a(91321),v=a(62816),J=a(23349),Ee=a(69677),g=a(26713),X=a(14538),Le=a(96619),b=a(20550),Fe=a(13013),L=a(66516),Oe=a(18537),Ne=a(42054),Me=a.n(Ne),e=a(85893),Pe=(0,Te.Z)({scriptUrl:"//at.alicdn.com/t/c/font_3875475_w5k22iyjel.js"}),f=J.Z.Column;E().locale("en");function ke(F){var u=[],d=new Set,h=G()(F),p;try{for(h.s();!(p=h.n()).done;){var m=p.value,S=JSON.stringify(m);d.has(S)||(u.push(m),d.add(S))}}catch(z){h.e(z)}finally{h.f()}return u}function ze(F){var u=[],d=G()(F),h;try{for(d.s();!(h=d.n()).done;){var p=h.value,m=p.Nebula_Node_Type;u.push(m)}}catch(S){d.e(S)}finally{d.f()}return u=ke(u),u}var we=function(u){var d=u.isFocused,h=u.counter,p=l.useState([]),m=c()(p,2),S=m[0],z=m[1],He=l.useState(!1),_=c()(He,2),Ye=_[0],$=_[1],Ve=l.useState(""),ee=c()(Ve,2),We=ee[0],w=ee[1],Ae=l.useState(""),te=c()(Ae,2),Be=te[0],ne=te[1],ae=l.useRef(null),Ge=l.useState([]),re=c()(Ge,2),xt=re[0],Qe=re[1],N=Oe.Z.parse(window.location.search),Je=l.useState(!1),se=c()(Je,2),Xe=se[0],U=se[1],be=l.useState({}),ie=c()(be,2),C=ie[0],K=ie[1],qe=l.useState([]),oe=c()(qe,2),_e=oe[0],et=oe[1],tt=l.useState(!1),le=c()(tt,2),nt=le[0],M=le[1],at=l.useState(!1),ce=c()(at,2),rt=ce[0],de=ce[1],st=l.useState([]),ue=c()(st,2),it=ue[0],ot=ue[1],lt=l.useState(0),ve=c()(lt,2),ct=ve[0],fe=ve[1],H=function(){var s=k()(I()().mark(function t(){var n,r;return I()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return $(!0),o.next=3,(0,Q._v)({params:N});case 3:n=o.sent,$(!1),n.error||(n.data.map(function(y,x){n.data[x].area_name=y.Nebula_Area.area_name,n.data[x].tenant_name=y.Nebula_Tenant.name}),z(n.data),Qe(n.data),r=ze(n.data),ot(r),r.length>0&&fe(r[0].type_id));case 6:case"end":return o.stop()}},t)}));return function(){return s.apply(this,arguments)}}(),dt=function(){var s=k()(I()().mark(function t(){var n;return I()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return $(!0),i.next=3,(0,Q.We)({},N.node_type);case 3:n=i.sent,$(!1),n.error||et(n.data);case 6:case"end":return i.stop()}},t)}));return function(){return s.apply(this,arguments)}}();l.useEffect(function(){d?(H(),dt()):O.history.push("/device/Node")},[d,h]);var he=function(t,n,r){n(),w(t[0]),ne(r)},ut=function(t){t(),w("")},D=function(t){return{filterDropdown:function(r){var i=r.setSelectedKeys,o=r.selectedKeys,y=r.confirm,x=r.clearFilters,xe=r.close;return(0,e.jsxs)("div",{style:{padding:8},onKeyDown:function(P){return P.stopPropagation()},children:[(0,e.jsx)(Ee.Z,{ref:ae,placeholder:"Search ".concat(t),value:o[0],onChange:function(P){return i(P.target.value?[P.target.value]:[])},onPressEnter:function(){return he(o,y,t)},style:{marginBottom:8,display:"block"}}),(0,e.jsxs)(g.Z,{children:[(0,e.jsx)(Z.Z,{type:"primary",onClick:function(){return he(o,y,t)},icon:(0,e.jsx)(v.l62,{}),size:"small",style:{width:90},children:"Search"}),(0,e.jsx)(Z.Z,{onClick:function(){return x&&ut(x)},size:"small",style:{width:90},children:"Reset"}),(0,e.jsx)(Z.Z,{type:"link",size:"small",onClick:function(){y({closeDropdown:!1}),w(o[0]),ne(t)},children:"Filter"}),(0,e.jsx)(Z.Z,{type:"link",size:"small",onClick:function(){xe()},children:"close"})]})]})},filterIcon:function(r){return(0,e.jsx)(v.l62,{style:{color:r?"#1890ff":void 0}})},onFilter:function(r,i){var o;return((o=i[t])!==null&&o!==void 0?o:"").toString().toLowerCase().includes(r.toLowerCase())},onFilterDropdownOpenChange:function(r){r&&setTimeout(function(){var i;return(i=ae.current)===null||i===void 0?void 0:i.select()},100)},render:function(r){return Be===t?(0,e.jsx)(Me(),{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[We],autoEscape:!0,textToHighlight:r?r.toString():""}):r}}},vt=function(t){X.Z.confirm({title:"Do you Want to unsign these node?",icon:(0,e.jsx)(v.SYL,{}),content:"Device Eui: "+t.devEui,onOk:function(){var n=k()(I()().mark(function i(){var o;return I()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return $(!0),x.next=3,(0,$e.TZ)({devEui:t.devEui,node_id:t.id});case 3:o=x.sent,$(!1),o.error||X.Z.success({content:"Success unsigned node "+t.devEui,onOk:function(){H()}});case 6:case"end":return x.stop()}},i)}));function r(){return n.apply(this,arguments)}return r}(),onCancel:function(){console.log("Cancel")}})};return(0,e.jsxs)(V._z,{childrenContentStyle:{minHeight:"70vh"},title:" ",extra:void 0,children:[(0,e.jsxs)(B.q,{children:[(0,e.jsx)("meta",{charSet:"utf-8"}),(0,e.jsx)("title",{children:"IKI IoT Platform | Device"}),(0,e.jsx)("link",{rel:"icon",href:"/iki-logo-no-text.png",type:"image/x-icon"})]}),(0,e.jsx)(Re.X,{device_id:C.id,open:Xe,onCancel:function(){return U(!1)},onOk:function(){U(!1)},typeName:N.node_type_name,devEui:C.devEui,desc:C.description}),(0,e.jsx)(Ze.Y,{devEui:C.devEui,open:nt,interval:C.interval,onCancel:function(){M(!1)},onOk:function(){M(!1),H()}}),(0,e.jsx)(Ie.T,{devEui:C.devEui,dataModal:C,open:rt,onCancel:function(){de(!1)},onOk:function(){de(!1)},typeName:N.node_type_name}),(0,e.jsx)(Le.Z,{activeKey:ct.toString(),onChange:function(t){fe(parseInt(t))},items:it.map(function(s){return{label:(0,e.jsxs)(g.Z,{align:"center",children:[(0,e.jsx)("img",{width:24,src:s.icon,alt:s.name}),s.name]}),key:s.type_id.toString()}})}),(0,e.jsxs)(J.Z,{dataSource:S,loading:Ye,scroll:{x:1300},children:[(0,e.jsx)(f,j()(j()({},D("tenant_name")),{},{width:200,title:"Tenant",dataIndex:"tenant_name",sorter:function(t,n){return t.tenant_name.length-n.tenant_name.length}})),(0,e.jsx)(f,j()({width:200,title:"Device Type",dataIndex:"device_type"},D("device_type")),"device_type"),(0,e.jsx)(f,j()({width:200,title:"Dev Eui",dataIndex:"devEui"},D("devEui")),"devEui"),(0,e.jsx)(f,j()({width:200,title:"Meter Id",dataIndex:"meter_id"},D("meter_id")),"meter_id"),(0,e.jsx)(f,j()({width:200,title:"Totalizer",dataIndex:"totalizer"},D("totalizer")),"totalizer"),(0,e.jsx)(f,{width:200,title:"Last Update",dataIndex:"lastUpdate",render:function(t){if(t)return E()(t).format("MMM DD YYYY HH:mm:ss")},sorter:function(t,n){return E()(t.lastUpdate).unix()-E()(n.lastUpdate).unix()}},"lastUpdate"),(0,e.jsx)(f,j()(j()({width:200,title:"Status",dataIndex:"status"},D("status")),{},{sorter:function(t,n){return t.status.length-n.status.length},render:function(t){return t==="ONLINE"?(0,e.jsx)(b.Z,{color:"green",children:t}):(0,e.jsx)(b.Z,{color:"red",children:t})}}),"status"),(0,e.jsx)(f,{width:130,title:"Interval",dataIndex:"interval",sorter:function(t,n){return t.interval-n.interval},render:function(t){return(0,e.jsxs)(g.Z,{children:[(0,e.jsx)(v.Wyb,{style:{color:"gray"}}),(0,e.jsxs)(A.Z,{children:[t," min"]})]})}},"interval"),(0,e.jsx)(f,{width:150,title:"Battery Level",dataIndex:"battery",sorter:function(t,n){return t.battery-n.battery},filters:[{text:(0,e.jsxs)(g.Z,{children:[(0,e.jsx)(R.QP,{}),"50 - 100"]}),value:"50-100"},{text:(0,e.jsxs)(g.Z,{children:[(0,e.jsx)(R.xT,{}),"20 - 50"]}),value:"20-50"},{text:(0,e.jsxs)(g.Z,{children:[(0,e.jsx)(R.t3,{style:{marginLeft:"3px"}})," ","0 - 20"]}),value:"0-20"}],onFilter:function(t,n){return t==="50-100"?n.battery>50:t==="20-50"?n.battery>20&&n.battery<=50:t==="0-20"?n.battery<=20:!0},render:function(t){return(0,e.jsx)(e.Fragment,{children:t>20&&t<=50?(0,e.jsxs)(g.Z,{children:[(0,e.jsx)(R.xT,{}),t]}):t<=20?(0,e.jsxs)(g.Z,{children:[(0,e.jsx)(R.t3,{}),t]}):t>50?(0,e.jsxs)(g.Z,{children:[(0,e.jsx)(R.QP,{}),t]}):null})}},"battery"),(0,e.jsx)(f,j()({width:200,title:"Description",dataIndex:"description"},D("description")),"description"),(0,e.jsx)(f,{dataIndex:"id",width:80,title:"Action",fixed:"right",render:function(t,n){return(0,e.jsx)(Fe.Z,{trigger:["click"],overlay:(0,e.jsxs)(L.Z,{children:[(0,e.jsxs)(L.Z.Item,{onClick:function(){U(!0),K(n)},children:[(0,e.jsx)(v.lY0,{}),"  ","View Log"]},"1"),(0,e.jsxs)(L.Z.Item,{onClick:function(){O.history.push("/device/edit?id=".concat(n.id,"&area_id=").concat(n.area_id,"&tenant_id=").concat(n.tenant_id))},children:[(0,e.jsx)(v.pW8,{}),"  ","Edit Device"]},"edit-device"),_e.map(function(r){var i=(0,e.jsx)(v.pW8,{}),o=function(){M(!0),K(n)};switch(r){case"interval":i=(0,e.jsx)(v.Wyb,{}),o=function(){M(!0),K(n)};break;case"meter reading":i=(0,e.jsx)(v.dU4,{});break;case"valve":i=(0,e.jsx)(Pe,{type:"icon-valve"});break;default:break}return(0,e.jsxs)(L.Z.Item,{onClick:function(){o()},style:{textTransform:"capitalize"},children:[i," ",r]},r)}),(0,e.jsxs)(L.Z.Item,{onClick:function(){vt(n)},style:{color:"red"},children:[(0,e.jsx)(v.E0z,{})," Unsign"]},"3")]}),placement:"bottomRight",children:(0,e.jsx)(Z.Z,{type:"text",children:(0,e.jsx)(v.xjY,{})})})}},"id")]})]})},q=we;E().locale("en");var Ue=function(){var u=l.useState(1),d=c()(u,2),h=d[0],p=d[1],m=(0,O.useParams)();return m.sub=="list"?(0,e.jsx)(q,{isFocused:!0,counter:h}):(0,e.jsxs)(V._z,{title:" ",style:{borderTop:"1px solid rgba(0, 0, 0, 0.06)"},childrenContentStyle:{minHeight:"75vh"},children:[(0,e.jsxs)(B.q,{children:[(0,e.jsx)("meta",{charSet:"utf-8"}),(0,e.jsx)("title",{children:"IKI IoT Platform | Device"}),(0,e.jsx)("link",{rel:"icon",href:"/iki-logo-no-text.png",type:"image/x-icon"})]}),(0,e.jsxs)(je.Z,{gutter:[16,16],children:[(0,e.jsxs)(W.Z,{xs:24,sm:24,md:24,lg:24,xl:24,xxl:24,style:{display:"flex",justifyContent:"space-between",borderBottom:"1px solid rgba(0, 0, 0, 0.06)",paddingBottom:"18px"},children:[(0,e.jsx)(A.Z.Title,{level:4,children:"Device Management"}),m.id?(0,e.jsxs)(Z.Z,{style:{},onClick:function(){O.history.push("/device/create")},children:[(0,e.jsx)(ye.Z,{})," Add Device"]}):null]}),(0,e.jsx)(W.Z,{span:24,children:(0,e.jsx)(q,{isFocused:!0,counter:0})})]})]})},Ke=Ue}}]);
